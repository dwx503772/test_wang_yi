<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="19">
  <HTTPTask id="50" hostname="192.168.0.106" path="/testlink/third_party/ext-js/ux/Exporter-all.js" url="http://192.168.0.106/testlink/third_party/ext-js/ux/Exporter-all.js" ip="192.168.0.106" port="80" connectionId="10" origin="Primary" frame="1" startTime="7443603" endTime="7443618">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Accept" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdCwgKi8qO3E9MC44</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cDovLzE5Mi4xNjguMC4xMDYvdGVzdGxpbmsvbGliL2dlbmVyYWwvbWFpblBhZ2UucGhw</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>emgtQ04=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKGNvbXBhdGlibGU7IE1TSUUgOS4wOyBXaW5kb3dzIE5UIDYuMTsgVHJpZGVudC81LjAp</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTkyLjE2OC4wLjEwNg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>UEhQU0VTU0lEPTY1NDAzaXUybGw5ZzdnY2ttdGJ2NWk1NTU3OyBURVNUTElOS19VU0VSX0FVVEhfQ09PS0lFPTVkYTY4M2JiOGYwMDRkZDM4MjAwMDc5OTBkYTQyY2JmZjI0NmJkNTZmZjRkZWZkNGJjZWJlNzdiNWMxMmQ2M2U=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC90ZXN0bGluay90aGlyZF9wYXJ0eS9leHQtanMvdXgvRXhwb3J0ZXItYWxsLmpzIEhUVFAvMS4xDQpBY2NlcHQ6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsICovKjtxPTAuOA0KUmVmZXJlcjogaHR0cDovLzE5Mi4xNjguMC4xMDYvdGVzdGxpbmsvbGliL2dlbmVyYWwvbWFpblBhZ2UucGhwDQpBY2NlcHQtTGFuZ3VhZ2U6IHpoLUNODQpVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSA5LjA7IFdpbmRvd3MgTlQgNi4xOyBUcmlkZW50LzUuMCkNCkFjY2VwdC1FbmNvZGluZzogZ3ppcCwgZGVmbGF0ZQ0KSG9zdDogMTkyLjE2OC4wLjEwNg0KQ29ubmVjdGlvbjogS2VlcC1BbGl2ZQ0KQ29va2llOiBQSFBTRVNTSUQ9NjU0MDNpdTJsbDlnN2dja210YnY1aTU1NTc7IFRFU1RMSU5LX1VTRVJfQVVUSF9DT09LSUU9NWRhNjgzYmI4ZjAwNGRkMzgyMDAwNzk5MGRhNDJjYmZmMjQ2YmQ1NmZmNGRlZmQ0YmNlYmU3N2I1YzEyZDYzZQ0KDQo=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="PHPSESSID" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>NjU0MDNpdTJsbDlnN2dja210YnY1aTU1NTc=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="TESTLINK_USER_AUTH_COOKIE" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>NWRhNjgzYmI4ZjAwNGRkMzgyMDAwNzk5MGRhNDJjYmZmMjQ2YmQ1NmZmNGRlZmQ0YmNlYmU3N2I1YzEyZDYzZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Date" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VHVlLCAxNiBBdWcgMjAxNiAxNTo1ODo1OSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Server" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QXBhY2hlLzIuNC4xMCAoVWJ1bnR1KQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Last-Modified" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U2F0LCAwMSBTZXAgMjAxMiAxMzo1NTozMCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>IjYzOWQtNGM4YTQ0MmVmMTg4MC1nemlwIg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Ranges" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ynl0ZXM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NjYxMQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Keep-Alive" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>dGltZW91dD01LCBtYXg9OTk=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpEYXRlOiBUdWUsIDE2IEF1ZyAyMDE2IDE1OjU4OjU5IEdNVA0KU2VydmVyOiBBcGFjaGUvMi40LjEwIChVYnVudHUpDQpMYXN0LU1vZGlmaWVkOiBTYXQsIDAxIFNlcCAyMDEyIDEzOjU1OjMwIEdNVA0KRVRhZzogIjYzOWQtNGM4YTQ0MmVmMTg4MC1nemlwIg0KQWNjZXB0LVJhbmdlczogYnl0ZXMNClZhcnk6IEFjY2VwdC1FbmNvZGluZw0KQ29udGVudC1FbmNvZGluZzogZ3ppcA0KQ29udGVudC1MZW5ndGg6IDY2MTENCktlZXAtQWxpdmU6IHRpbWVvdXQ9NSwgbWF4PTk5DQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>LyoqCioKKiAgQmFzZTY0IGVuY29kZSAvIGRlY29kZQoqICBodHRwOi8vd3d3LndlYnRvb2xraXQuaW5mby8KKgoqKi8KCnZhciBCYXNlNjQgPSAoZnVuY3Rpb24oKSB7CgogICAgLy8gcHJpdmF0ZSBwcm9wZXJ0eQogICAgdmFyIGtleVN0ciA9ICJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSI7CgogICAgLy8gcHJpdmF0ZSBtZXRob2QgZm9yIFVURi04IGVuY29kaW5nCiAgICBmdW5jdGlvbiB1dGY4RW5jb2RlKHN0cmluZykgewogICAgICAgIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9cclxuL2csIlxuIik7CiAgICAgICAgdmFyIHV0ZnRleHQgPSAiIjsKICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IHN0cmluZy5sZW5ndGg7IG4rKykgewogICAgICAgICAgICB2YXIgYyA9IHN0cmluZy5jaGFyQ29kZUF0KG4pOwogICAgICAgICAgICBpZiAoYyA8IDEyOCkgewogICAgICAgICAgICAgICAgdXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYoKGMgPiAxMjcpICYmIChjIDwgMjA0OCkpIHsKICAgICAgICAgICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyA+PiA2KSB8IDE5Mik7CiAgICAgICAgICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKChjID4+IDEyKSB8IDIyNCk7CiAgICAgICAgICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjID4+IDYpICYgNjMpIHwgMTI4KTsKICAgICAgICAgICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyAmIDYzKSB8IDEyOCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHV0ZnRleHQ7CiAgICB9CgogICAgLy8gcHVibGljIG1ldGhvZCBmb3IgZW5jb2RpbmcKICAgIHJldHVybiB7CiAgICAgICAgLy9UaGlzIHdhcyB0aGUgb3JpZ2luYWwgbGluZSwgd2hpY2ggdHJpZXMgdG8gdXNlIEZpcmVmb3gncyBidWlsdCBpbiBCYXNlNjQgZW5jb2RlciwgYnV0IHRoaXMga2VwdCB0aHJvd2luZyBleGNlcHRpb25zLi4uLgogICAgICAgIC8vIGVuY29kZSA6ICh0eXBlb2YgYnRvYSA9PSAnZnVuY3Rpb24nKSA/IGZ1bmN0aW9uKGlucHV0KSB7IHJldHVybiBidG9hKGlucHV0KTsgfSA6IGZ1bmN0aW9uIChpbnB1dCkgewogICAgICAgIAogICAgICAgIAogICAgICAgIGVuY29kZSA6IGZ1bmN0aW9uIChpbnB1dCkgewogICAgICAgICAgICB2YXIgb3V0cHV0ID0gIiI7CiAgICAgICAgICAgIHZhciBjaHIxLCBjaHIyLCBjaHIzLCBlbmMxLCBlbmMyLCBlbmMzLCBlbmM0OwogICAgICAgICAgICB2YXIgaSA9IDA7CiAgICAgICAgICAgIGlucHV0ID0gdXRmOEVuY29kZShpbnB1dCk7CiAgICAgICAgICAgIHdoaWxlIChpIDwgaW5wdXQubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBjaHIxID0gaW5wdXQuY2hhckNvZGVBdChpKyspOwogICAgICAgICAgICAgICAgY2hyMiA9IGlucHV0LmNoYXJDb2RlQXQoaSsrKTsKICAgICAgICAgICAgICAgIGNocjMgPSBpbnB1dC5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICBlbmMxID0gY2hyMSA+PiAyOwogICAgICAgICAgICAgICAgZW5jMiA9ICgoY2hyMSAmIDMpIDw8IDQpIHwgKGNocjIgPj4gNCk7CiAgICAgICAgICAgICAgICBlbmMzID0gKChjaHIyICYgMTUpIDw8IDIpIHwgKGNocjMgPj4gNik7CiAgICAgICAgICAgICAgICBlbmM0ID0gY2hyMyAmIDYzOwogICAgICAgICAgICAgICAgaWYgKGlzTmFOKGNocjIpKSB7CiAgICAgICAgICAgICAgICAgICAgZW5jMyA9IGVuYzQgPSA2NDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNOYU4oY2hyMykpIHsKICAgICAgICAgICAgICAgICAgICBlbmM0ID0gNjQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQgKwogICAgICAgICAgICAgICAga2V5U3RyLmNoYXJBdChlbmMxKSArIGtleVN0ci5jaGFyQXQoZW5jMikgKwogICAgICAgICAgICAgICAga2V5U3RyLmNoYXJBdChlbmMzKSArIGtleVN0ci5jaGFyQXQoZW5jNCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIG91dHB1dDsKICAgICAgICB9CiAgICB9Owp9KSgpOwoKLyoqCiAqIEBjbGFzcyBFeHQudXguRXhwb3J0ZXIKICogQGF1dGhvciBFZCBTcGVuY2VyIChodHRwOi8vZWRzcGVuY2VyLm5ldCkKICogQ2xhc3MgcHJvdmlkaW5nIGEgY29tbW9uIHdheSBvZiBkb3dubG9hZGluZyBkYXRhIGluIC54bHMgb3IgLmNzdiBmb3JtYXQKICovCkV4dC51eC5FeHBvcnRlciA9IGZ1bmN0aW9uKCkgewogIHJldHVybiB7CiAgICAvKioKICAgICAqIEV4cG9ydHMgYSBncmlkLCB1c2luZyB0aGUgLnhscyBmb3JtYXR0ZXIgYnkgZGVmYXVsdAogICAgICogQHBhcmFtIHtFeHQuZ3JpZC5HcmlkUGFuZWx9IGdyaWQgVGhlIGdyaWQgdG8gZXhwb3J0IGZyb20KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgT3B0aW9uYWwgY29uZmlnIHNldHRpbmdzIGZvciB0aGUgZm9ybWF0dGVyCiAgICAgKi8KICAgIGV4cG9ydEdyaWQ6IGZ1bmN0aW9uKGdyaWQsIGZvcm1hdHRlciwgY29uZmlnKSB7CiAgICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTsKICAgICAgZm9ybWF0dGVyID0gZm9ybWF0dGVyIHx8IG5ldyBFeHQudXguRXhwb3J0ZXIuRXhjZWxGb3JtYXR0ZXIoKTsKICAgICAgCiAgICAgIEV4dC5hcHBseUlmKGNvbmZpZywgewogICAgICAgIHRpdGxlICA6IGdyaWQudGl0bGUsCiAgICAgICAgY29sdW1uczogZ3JpZC5nZXRDb2x1bW5Nb2RlbCgpLmNvbmZpZwogICAgICB9KTsKICAgICAgCiAgICAgIHJldHVybiBCYXNlNjQuZW5jb2RlKGZvcm1hdHRlci5mb3JtYXQoZ3JpZC5zdG9yZSwgY29uZmlnKSk7CiAgICB9LAogICAgCiAgICBleHBvcnRTdG9yZTogZnVuY3Rpb24oc3RvcmUsIGZvcm1hdHRlciwgY29uZmlnKSB7CiAgICAgICBjb25maWcgPSBjb25maWcgfHwge307CiAgICAgICBmb3JtYXR0ZXIgPSBmb3JtYXR0ZXIgfHwgbmV3IEV4dC51eC5FeHBvcnRlci5FeGNlbEZvcm1hdHRlcigpOwoKICAgICAgIEV4dC5hcHBseUlmKGNvbmZpZywgewogICAgICAgICBjb2x1bW5zOiBjb25maWcuc3RvcmUuZmllbGRzLml0ZW1zCiAgICAgICB9KTsKICAgICAgIAogICAgICAgcmV0dXJuIEJhc2U2NC5lbmNvZGUoZm9ybWF0dGVyLmZvcm1hdChzdG9yZSwgY29uZmlnKSk7CiAgICB9LAogICAgCiAgICBleHBvcnRUcmVlOiBmdW5jdGlvbih0cmVlLCBmb3JtYXR0ZXIsIGNvbmZpZykgewogICAgICBjb25maWcgICAgPSBjb25maWcgfHwge307CiAgICAgIGZvcm1hdHRlciA9IGZvcm1hdHRlciB8fCBuZXcgRXh0LnV4LkV4cG9ydGVyLkV4Y2VsRm9ybWF0dGVyKCk7CiAgICAgIAogICAgICB2YXIgc3RvcmUgPSB0cmVlLnN0b3JlIHx8IGNvbmZpZy5zdG9yZTsKCiAgICAgIEV4dC5hcHBseUlmKGNvbmZpZywgewogICAgICAgIHRpdGxlOiB0cmVlLnRpdGxlCiAgICAgIH0pOwogICAgICAKICAgICAgcmV0dXJuIEJhc2U2NC5lbmNvZGUoZm9ybWF0dGVyLmZvcm1hdChzdG9yZSwgY29uZmlnKSk7CiAgICB9CiAgfTsKfSgpOwoKLyoqCiAqIEBjbGFzcyBFeHQudXguRXhwb3J0ZXIuQnV0dG9uCiAqIEBleHRlbmRzIEV4dC5CdXR0b24KICogQGF1dGhvciBOaWdlIFdoaXRlLCB3aXRoIG1vZGlmaWNhdGlvbnMgZnJvbSBFZCBTcGVuY2VyCiAqIFNwZWNpYWxpc2VkIEJ1dHRvbiBjbGFzcyB0aGF0IGFsbG93cyBkb3dubG9hZGluZyBvZiBkYXRhIHZpYSBkYXRhOiB1cmxzLgogKiBJbnRlcm5hbGx5LCB0aGlzIGlzIGp1c3QgYSBsaW5rLgogKiBQYXNzIGl0IGVpdGhlciBhbiBFeHQuQ29tcG9uZW50IHN1YmNsYXNzIHdpdGggYSAnc3RvcmUnIHByb3BlcnR5LCBvciBqdXN0IGEgc3RvcmU6CiAqIG5ldyBFeHQudXguRXhwb3J0ZXIuQnV0dG9uKHtjb21wb25lbnQ6IHNvbWVHcmlkfSk7CiAqIG5ldyBFeHQudXguRXhwb3J0ZXIuQnV0dG9uKHtzdG9yZTogc29tZVN0b3JlfSk7CiAqIEBjZmcge0V4dC5Db21wb25lbnR9IGNvbXBvbmVudCBUaGUgY29tcG9uZW50IHRoZSBzdG9yZSBpcyBib3VuZCB0bwogKiBAY2ZnIHtFeHQuZGF0YS5TdG9yZX0gc3RvcmUgVGhlIHN0b3JlIHRvIGV4cG9ydCAoYWx0ZXJuYXRpdmVseSwgcGFzcyBhIGNvbXBvbmVudCB3aXRoIGEgc3RvcmUgcHJvcGVydHkpCiAqLwpFeHQudXguRXhwb3J0ZXIuQnV0dG9uID0gRXh0LmV4dGVuZChFeHQuQnV0dG9uLCB7CiAgY29uc3RydWN0b3I6IGZ1bmN0aW9uKGNvbmZpZykgewogICAgY29uZmlnID0gY29uZmlnIHx8IHt9OwogICAgCiAgICBFeHQuYXBwbHlJZihjb25maWcsIHsKICAgICAgZXhwb3J0RnVuY3Rpb246ICdleHBvcnRHcmlkJywKICAgICAgZGlzYWJsZWQgICAgICA6IGZhbHNlLAogICAgICB0ZXh0ICAgICAgICAgIDogJ0Rvd25sb2FkJywKICAgICAgY2xzICAgICAgICAgICA6ICdkb3dubG9hZCcKICAgIH0pOwoKICAgIGlmIChjb25maWcuc3RvcmUgPT0gdW5kZWZpbmVkICYmIGNvbmZpZy5jb21wb25lbnQgIT0gdW5kZWZpbmVkKSB7CiAgICAgIEV4dC5hcHBseUlmKGNvbmZpZywgewogICAgICAgIHN0b3JlOiBjb25maWcuY29tcG9uZW50LnN0b3JlCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgRXh0LmFwcGx5SWYoY29uZmlnLCB7CiAgICAgICAgY29tcG9uZW50OiB7CiAgICAgICAgICBzdG9yZTogY29uZmlnLnN0b3JlCiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIAogICAgRXh0LnV4LkV4cG9ydGVyLkJ1dHRvbi5zdXBlcmNsYXNzLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgY29uZmlnKTsKICAgIAogICAgaWYgKHRoaXMuc3RvcmUgJiYgRXh0LmlzRnVuY3Rpb24odGhpcy5zdG9yZS5vbikpIHsKICAgICAgdmFyIHNldExpbmsgPSBmdW5jdGlvbigpIHsKICAgICAgICB0aGlzLmdldEVsKCkuY2hpbGQoJ2EnLCB0cnVlKS5ocmVmID0gJ2RhdGE6YXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsO2Jhc2U2NCwnICsgRXh0LnV4LkV4cG9ydGVyW2NvbmZpZy5leHBvcnRGdW5jdGlvbl0odGhpcy5jb21wb25lbnQsIG51bGwsIGNvbmZpZyk7CiAgICAgICAgCiAgICAgICAgdGhpcy5lbmFibGUoKTsKICAgICAgfTsKICAgICAgCiAgICAgIGlmICh0aGlzLmVsKSB7CiAgICAgICAgc2V0TGluay5jYWxsKHRoaXMpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMub24oJ3JlbmRlcicsIHNldExpbmssIHRoaXMpOwogICAgICB9CiAgICAgIAogICAgICB0aGlzLnN0b3JlLm9uKCdsb2FkJywgc2V0TGluaywgdGhpcyk7CiAgICB9CiAgfSwKICAKICB0ZW1wbGF0ZTogbmV3IEV4dC5UZW1wbGF0ZSgKICAgICc8dGFibGUgYm9yZGVyPSIwIiBjZWxscGFkZGluZz0iMCIgY2VsbHNwYWNpbmc9IjAiIGNsYXNzPSJ4LWJ0bi13cmFwIj48dGJvZHk+PHRyPicsCiAgICAnPHRkIGNsYXNzPSJ4LWJ0bi1sZWZ0Ij48aT4gPC9pPjwvdGQ+PHRkIGNsYXNzPSJ4LWJ0bi1jZW50ZXIiPjxhIGNsYXNzPSJ4LWJ0bi10ZXh0IiBocmVmPSJ7MX0iIHRhcmdldD0iezJ9Ij57MH08L2E+PC90ZD48dGQgY2xhc3M9IngtYnRuLXJpZ2h0Ij48aT4gPC9pPjwvdGQ+JywKICAgICI8L3RyPjwvdGJvZHk+PC90YWJsZT4iKSwKCiAgICBvblJlbmRlcjogICBmdW5jdGlvbihjdCwgcG9zaXRpb24pewogICAgICB2YXIgYnRuLCB0YXJncyA9IFt0aGlzLnRleHQgfHwgJyAnLCB0aGlzLmhyZWYsIHRoaXMudGFyZ2V0IHx8ICJfc2VsZiJdOwogICAgICBpZiAocG9zaXRpb24pewogICAgICAgIGJ0biA9IHRoaXMudGVtcGxhdGUuaW5zZXJ0QmVmb3JlKHBvc2l0aW9uLCB0YXJncywgdHJ1ZSk7CiAgICAgIH1lbHNlewogICAgICAgIGJ0biA9IHRoaXMudGVtcGxhdGUuYXBwZW5kKGN0LCB0YXJncywgdHJ1ZSk7CiAgICAgIH0KICAgICAgdmFyIGJ0bkVsID0gYnRuLmNoaWxkKCJhOmZpcnN0Iik7CiAgICAgIHRoaXMuYnRuRWwgPSBidG5FbDsKICAgICAgYnRuRWwub24oJ2ZvY3VzJywgdGhpcy5vbkZvY3VzLCB0aGlzKTsKICAgICAgYnRuRWwub24oJ2JsdXInLCB0aGlzLm9uQmx1ciwgdGhpcyk7CgogICAgICB0aGlzLmluaXRCdXR0b25FbChidG4sIGJ0bkVsKTsKICAgICAgRXh0LkJ1dHRvblRvZ2dsZU1nci5yZWdpc3Rlcih0aGlzKTsKICAgIH0sCgogICAgb25DbGljayA6IGZ1bmN0aW9uKGUpewogICAgICBpZiAoZS5idXR0b24gIT0gMCkgcmV0dXJuOwogICAgICAKICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKXsKICAgICAgICB0aGlzLmZpcmVFdmVudCgiY2xpY2siLCB0aGlzLCBlKTsKICAgICAgICAKICAgICAgICBpZiAodGhpcy5oYW5kbGVyKSB0aGlzLmhhbmRsZXIuY2FsbCh0aGlzLnNjb3BlIHx8IHRoaXMsIHRoaXMsIGUpOwogICAgICB9CiAgICB9Cn0pOwoKRXh0LnJlZygnZXhwb3J0YnV0dG9uJywgRXh0LnV4LkV4cG9ydGVyLkJ1dHRvbik7CgovKioKICogQGNsYXNzIEV4dC51eC5FeHBvcnRlci5Gb3JtYXR0ZXIKICogQGF1dGhvciBFZCBTcGVuY2VyIChodHRwOi8vZWRzcGVuY2VyLm5ldCkKICogQGNmZyB7RXh0LmRhdGEuU3RvcmV9IHN0b3JlIFRoZSBzdG9yZSB0byBleHBvcnQKICovCkV4dC51eC5FeHBvcnRlci5Gb3JtYXR0ZXIgPSBmdW5jdGlvbihjb25maWcpIHsKICBjb25maWcgPSBjb25maWcgfHwge307CiAgICAgICAgCiAgRXh0LmFwcGx5SWYoY29uZmlnLCB7CiAgICAKICB9KTsKfTsKCkV4dC51eC5FeHBvcnRlci5Gb3JtYXR0ZXIucHJvdG90eXBlID0gewogIC8qKgogICAqIFBlcmZvcm1zIHRoZSBhY3R1YWwgZm9ybWF0dGluZy4gVGhpcyBtdXN0IGJlIG92ZXJyaWRkZW4gYnkgYSBzdWJjbGFzcwogICAqLwogIGZvcm1hdDogRXh0LmVtcHR5Rm4KfTsKCi8qKgogKiBAY2xhc3MgRXh0LnV4LkV4cG9ydGVyLkV4Y2VsRm9ybWF0dGVyCiAqIEBleHRlbmRzIEV4dC51eC5FeHBvcnRlci5Gb3JtYXR0ZXIKICogU3BlY2lhbGlzZWQgRm9ybWF0IGNsYXNzIGZvciBvdXRwdXR0aW5nIC54bHMgZmlsZXMKICovCkV4dC51eC5FeHBvcnRlci5FeGNlbEZvcm1hdHRlciA9IEV4dC5leHRlbmQoRXh0LnV4LkV4cG9ydGVyLkZvcm1hdHRlciwgewogIAogIGZvcm1hdDogZnVuY3Rpb24oc3RvcmUsIGNvbmZpZykgewogICAgdmFyIHdvcmtib29rID0gbmV3IEV4dC51eC5FeHBvcnRlci5FeGNlbEZvcm1hdHRlci5Xb3JrYm9vayhjb25maWcpOwogICAgd29ya2Jvb2suYWRkV29ya3NoZWV0KHN0b3JlLCBjb25maWcgfHwge30pOwogICAgCiAgICByZXR1cm4gd29ya2Jvb2sucmVuZGVyKCk7CiAgfQp9KTsKCi8qKgogKiBAY2xhc3MgRXh0LnV4LkV4cG9ydGVyLkV4Y2VsRm9ybWF0dGVyLldvcmtib29rCiAqIEBleHRlbmRzIE9iamVjdAogKiBSZXByZXNlbnRzIGFuIEV4Y2VsIHdvcmtib29rCiAqLwpFeHQudXguRXhwb3J0ZXIuRXhjZWxGb3JtYXR0ZXIuV29ya2Jvb2sgPSBFeHQuZXh0ZW5kKE9iamVjdCwgewogIAogIGNvbnN0cnVjdG9yOiBmdW5jdGlvbihjb25maWcpIHsKICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTsKICAgIAogICAgRXh0LmFwcGx5KHRoaXMsIGNvbmZpZywgewogICAgICAvKioKICAgICAgICogQHByb3BlcnR5IHRpdGxlCiAgICAgICAqIEB0eXBlIFN0cmluZwogICAgICAgKiBUaGUgdGl0bGUgb2YgdGhlIHdvcmtib29rIChkZWZhdWx0cyB0byAiV29ya2Jvb2siKQogICAgICAgKi8KICAgICAgdGl0bGU6ICJXb3JrYm9vayIsCiAgICAgIAogICAgICAvKioKICAgICAgICogQHByb3BlcnR5IHdvcmtzaGVldHMKICAgICAgICogQHR5cGUgQXJyYXkKICAgICAgICogVGhlIGFycmF5IG9mIHdvcmtzaGVldHMgaW5zaWRlIHRoaXMgd29ya2Jvb2sKICAgICAgICovCiAgICAgIHdvcmtzaGVldHM6IFtdLAogICAgICAKICAgICAgLyoqCiAgICAgICAqIEBwcm9wZXJ0eSBjb21waWxlV29ya3NoZWV0cwogICAgICAgKiBAdHlwZSBBcnJheQogICAgICAgKiBBcnJheSBvZiBhbGwgcmVuZGVyZWQgV29ya3NoZWV0cwogICAgICAgKi8KICAgICAgY29tcGlsZWRXb3Jrc2hlZXRzOiBbXSwKICAgICAgCiAgICAgIC8qKgogICAgICAgKiBAcHJvcGVydHkgY2VsbEJvcmRlckNvbG9yCiAgICAgICAqIEB0eXBlIFN0cmluZwogICAgICAgKiBUaGUgY29sb3VyIG9mIGJvcmRlciB0byB1c2UgZm9yIGVhY2ggQ2VsbAogICAgICAgKi8KICAgICAgY2VsbEJvcmRlckNvbG9yOiAiI2U0ZTRlNCIsCiAgICAgIAogICAgICAvKioKICAgICAgICogQHByb3BlcnR5IHN0eWxlcwogICAgICAgKiBAdHlwZSBBcnJheQogICAgICAgKiBUaGUgYXJyYXkgb2YgRXh0LnV4LkV4cG9ydGVyLkV4Y2VsRm9ybWF0dGVyLlN0eWxlIG9iamVjdHMgYXR0YWNoZWQgdG8gdGhpcyB3b3JrYm9vawogICAgICAgKi8KICAgICAgc3R5bGVzOiBbXSwKICAgICAgCiAgICAgIC8qKgogICAgICAgKiBAcHJvcGVydHkgY29tcGlsZWRTdHlsZXMKICAgICAgICogQHR5cGUgQXJyYXkKICAgICAgICogQXJyYXkgb2YgYWxsIHJlbmRlcmVkIEV4dC51eC5FeHBvcnRlci5FeGNlbEZvcm1hdHRlci5TdHlsZSBvYmplY3RzIGZvciB0aGlzIHdvcmtib29rCiAgICAgICAqLwogICAgICBjb21waWxlZFN0eWxlczogW10sCiAgICAgIAogICAgICAvKioKICAgICAgICogQHByb3BlcnR5IGhhc0RlZmF1bHRTdHlsZQogICAgICAgKiBAdHlwZSBCb29sZWFuCiAgICAgICAqIFRydWUgdG8gYWRkIHRoZSBkZWZhdWx0IHN0eWxpbmcgb3B0aW9ucyB0byBhbGwgY2VsbHMgKGRlZmF1bHRzIHRvIHRydWUpCiAgICAgICAqLwogICAgICBoYXNEZWZhdWx0U3R5bGU6IHRydWUsCiAgICAgIAogICAgICAvKioKICAgICAgICogQHByb3BlcnR5IGhhc1N0cmlwZVN0eWxlcwogICAgICAgKiBAdHlwZSBCb29sZWFuCiAgICAgICAqIFRydWUgdG8gYWRkIHRoZSBzdHJpcGluZyBzdHlsZXMgKGRlZmF1bHRzIHRvIHRydWUpCiAgICAgICAqLwogICAgICBoYXNTdHJpcGVTdHlsZXM6IHRydWUsCiAgICAgIAogICAgICB3aW5kb3dIZWlnaHQgICAgOiA5MDAwLAogICAgICB3aW5kb3dXaWR0aCAgICAgOiA1MDAwMCwgICAgICAKICAgICAgcHJvdGVjdFN0cnVjdHVyZTogZmFsc2UsCiAgICAgIHByb3RlY3RXaW5kb3dzICA6IGZhbHNlCiAgICB9KTsKICAgIAogICAgaWYgKHRoaXMuaGFzRGVmYXVsdFN0eWxlKSB0aGlzLmFkZERlZmF1bHRTdHlsZSgpOwogICAgaWYgKHRoaXMuaGFzU3RyaXBlU3R5bGVzKSB0aGlzLmFkZFN0cmlwZWRTdHlsZXMoKTsKICAgIAogICAgdGhpcy5hZGRUaXRsZVN0eWxlKCk7CiAgICB0aGlzLmFkZEhlYWRlclN0eWxlKCk7CiAgfSwKICAKICByZW5kZXI6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5jb21waWxlU3R5bGVzKCk7CiAgICB0aGlzLmpvaW5lZENvbXBpbGVkU3R5bGVzID0gdGhpcy5jb21waWxlZFN0eWxlcy5qb2luKCIiKTsKICAgIAogICAgdGhpcy5jb21waWxlV29ya3NoZWV0cygpOwogICAgdGhpcy5qb2luZWRXb3Jrc2hlZXRzID0gdGhpcy5jb21waWxlZFdvcmtzaGVldHMuam9pbigiIik7CiAgICAKICAgIHJldHVybiB0aGlzLnRwbC5hcHBseSh0aGlzKTsKICB9LAogIAogIC8qKgogICAqIEFkZHMgYSB3b3Jrc2hlZXQgdG8gdGhpcyB3b3JrYm9vayBiYXNlZCBvbiBhIHN0b3JlIGFuZCBvcHRpb25hbCBjb25maWcKICAgKiBAcGFyYW0ge0V4dC5kYXRhLlN0b3JlfSBzdG9yZSBUaGUgc3RvcmUgdG8gaW5pdGlhbGl6ZSB0aGUgd29ya3NoZWV0IHdpdGgKICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIE9wdGlvbmFsIGNvbmZpZyBvYmplY3QKICAgKiBAcmV0dXJuIHtFeHQudXguRXhwb3J0ZXIuRXhjZWxGb3JtYXR0ZXIuV29ya3NoZWV0fSBUaGUgd29ya3NoZWV0CiAgICovCiAgYWRkV29ya3NoZWV0OiBmdW5jdGlvbihzdG9yZSwgY29uZmlnKSB7CiAgICB2YXIgd29ya3NoZWV0ID0gbmV3IEV4dC51eC5FeHBvcnRlci5FeGNlbEZvcm1hdHRlci5Xb3Jrc2hlZXQoc3RvcmUsIGNvbmZpZyk7CiAgICAKICAgIHRoaXMud29ya3NoZWV0cy5wdXNoKHdvcmtzaGVldCk7CiAgICAKICAgIHJldHVybiB3b3Jrc2hlZXQ7CiAgfSwKICAKICAvKioKICAgKiBBZGRzIGEgbmV3IEV4dC51eC5FeHBvcnRlci5FeGNlbEZvcm1hdHRlci5TdHlsZSB0byB0aGlzIFdvcmtib29rCiAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgc3R5bGUgY29uZmlnLCBwYXNzZWQgdG8gdGhlIFN0eWxlIGNvbnN0cnVjdG9yIChyZXF1aXJlZCkKICAgKi8KICBhZGRTdHlsZTogZnVuY3Rpb24oY29uZmlnKSB7CiAgICB2YXIgc3R5bGUgPSBuZXcgRXh0LnV4LkV4cG9ydGVyLkV4Y2VsRm9ybWF0dGVyLlN0eWxlKGNvbmZpZyB8fCB7fSk7CiAgICAKICAgIHRoaXMuc3R5bGVzLnB1c2goc3R5bGUpOwogICAgCiAgICByZXR1cm4gc3R5bGU7CiAgfSwKICAKICAvKioKICAgKiBDb21waWxlcyBlYWNoIFN0eWxlIGF0dGFjaGVkIHRvIHRoaXMgV29ya2Jvb2sgYnkgcmVuZGVyaW5nIGl0CiAgICogQHJldHVybiB7QXJyYXl9IFRoZSBjb21waWxlZCBzdHlsZXMgYXJyYXkKICAgKi8KICBjb21waWxlU3R5bGVzOiBmdW5jdGlvbigpIHsKICAgIHRoaXMuY29tcGlsZWRTdHlsZXMgPSBbXTsKICAgIAogICAgRXh0LmVhY2godGhpcy5zdHlsZXMsIGZ1bmN0aW9uKHN0eWxlKSB7CiAgICAgIHRoaXMuY29tcGlsZWRTdHlsZXMucHVzaChzdHlsZS5yZW5kZXIoKSk7CiAgICB9LCB0aGlzKTsKICAgIAogICAgcmV0dXJuIHRoaXMuY29tcGlsZWRTdHlsZXM7CiAgfSwKICAKICAvKioKICAgKiBDb21waWxlcyBlYWNoIFdvcmtzaGVldCBhdHRhY2hlZCB0byB0aGlzIFdvcmtib29rIGJ5IHJlbmRlcmluZyBpdAogICAqIEByZXR1cm4ge0FycmF5fSBUaGUgY29tcGlsZWQgd29ya3NoZWV0cyBhcnJheQogICAqLwogIGNvbXBpbGVXb3Jrc2hlZXRzOiBmdW5jdGlvbigpIHsKICAgIHRoaXMuY29tcGlsZWRXb3Jrc2hlZXRzID0gW107CiAgICAKICAgIEV4dC5lYWNoKHRoaXMud29ya3NoZWV0cywgZnVuY3Rpb24od29ya3NoZWV0KSB7CiAgICAgIHRoaXMuY29tcGlsZWRXb3Jrc2hlZXRzLnB1c2god29ya3NoZWV0LnJlbmRlcigpKTsKICAgIH0sIHRoaXMpOwogICAgCiAgICByZXR1cm4gdGhpcy5jb21waWxlZFdvcmtzaGVldHM7CiAgfSwKICAKICB0cGw6IG5ldyBFeHQuWFRlbXBsYXRlKAogICAgJzw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9InV0Zi04Ij8+JywKICAgICc8c3M6V29ya2Jvb2sgeG1sbnM6c3M9InVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOnNwcmVhZHNoZWV0IiB4bWxuczp4PSJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOm9mZmljZTpleGNlbCIgeG1sbnM6bz0idXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTpvZmZpY2U6b2ZmaWNlIj4nLAogICAgICAnPG86RG9jdW1lbnRQcm9wZXJ0aWVzPicsCiAgICAgICAgJzxvOlRpdGxlPnt0aXRsZX08L286VGl0bGU+JywKICAgICAgJzwvbzpEb2N1bWVudFByb3BlcnRpZXM+JywKICAgICAgJzxzczpFeGNlbFdvcmtib29rPicsCiAgICAgICAgJzxzczpXaW5kb3dIZWlnaHQ+e3dpbmRvd0hlaWdodH08L3NzOldpbmRvd0hlaWdodD4nLAogICAgICAgICc8c3M6V2luZG93V2lkdGg+e3dpbmRvd1dpZHRofTwvc3M6V2luZG93V2lkdGg+JywKICAgICAgICAnPHNzOlByb3RlY3RTdHJ1Y3R1cmU+e3Byb3RlY3RTdHJ1Y3R1cmV9PC9zczpQcm90ZWN0U3RydWN0dXJlPicsCiAgICAgICAgJzxzczpQcm90ZWN0V2luZG93cz57cHJvdGVjdFdpbmRvd3N9PC9zczpQcm90ZWN0V2luZG93cz4nLAogICAgICAnPC9zczpFeGNlbFdvcmtib29rPicsCiAgICAgICc8c3M6U3R5bGVzPicsCiAgICAgICAgJ3tqb2luZWRDb21waWxlZFN0eWxlc30nLAogICAgICAnPC9zczpTdHlsZXM+JywKICAgICAgICAne2pvaW5lZFdvcmtzaGVldHN9JywKICAgICc8L3NzOldvcmtib29rPicgICAgCiAgKSwKICAKICAvKioKICAgKiBBZGRzIHRoZSBkZWZhdWx0IFN0eWxlIHRvIHRoaXMgd29ya2Jvb2suIFRoaXMgc2V0cyB0aGUgZGVmYXVsdCBmb250IGZhY2UgYW5kIHNpemUsIGFzIHdlbGwgYXMgY2VsbCBib3JkZXJzCiAgICovCiAgYWRkRGVmYXVsdFN0eWxlOiBmdW5jdGlvbigpIHsKICAgIHZhciBib3JkZXJQcm9wZXJ0aWVzID0gWwogICAgICB7bmFtZTogIkNvbG9yIiwgICAgIHZhbHVlOiB0aGlzLmNlbGxCb3JkZXJDb2xvcn0sCiAgICAgIHtuYW1lOiAiV2VpZ2h0IiwgICAgdmFsdWU6ICIxIn0sCiAgICAgIHtuYW1lOiAiTGluZVN0eWxlIiwgdmFsdWU6ICJDb250aW51b3VzIn0KICAgIF07CiAgICAKICAgIHRoaXMuYWRkU3R5bGUoewogICAgICBpZDogJ0RlZmF1bHQnLAogICAgICBhdHRyaWJ1dGVzOiBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogIkFsaWdubWVudCIsCiAgICAgICAgICBwcm9wZXJ0aWVzOiBbCiAgICAgICAgICAgIHtuYW1lOiAiVmVydGljYWwiLCB2YWx1ZTogIlRvcCJ9LAogICAgICAgICAgICB7bmFtZTogIldyYXBUZXh0IiwgdmFsdWU6ICIxIn0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJGb250IiwKICAgICAgICAgIHByb3BlcnRpZXM6IFsKICAgICAgICAgICAge25hbWU6ICJGb250TmFtZSIsIHZhbHVlOiAiYXJpYWwifSwKICAgICAgICAgICAge25hbWU6ICJTaXplIiwgICAgIHZhbHVlOiAiMTAifQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAge25hbWU6ICJJbnRlcmlvciJ9LCB7bmFtZTogIk51bWJlckZvcm1hdCJ9LCB7bmFtZTogIlByb3RlY3Rpb24ifSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAiQm9yZGVycyIsCiAgICAgICAgICBjaGlsZHJlbjogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogIkJvcmRlciIsCiAgICAgICAgICAgICAgcHJvcGVydGllczogW3tuYW1lOiAiUG9zaXRpb24iLCB2YWx1ZTogIlRvcCJ9XS5jb25jYXQoYm9yZGVyUHJvcGVydGllcykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJCb3JkZXIiLAogICAgICAgICAgICAgIHByb3BlcnRpZXM6IFt7bmFtZTogIlBvc2l0aW9uIiwgdmFsdWU6ICJCb3R0b20ifV0uY29uY2F0KGJvcmRlclByb3BlcnRpZXMpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiQm9yZGVyIiwKICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiBbe25hbWU6ICJQb3NpdGlvbiIsIHZhbHVlOiAiTGVmdCJ9XS5jb25jYXQoYm9yZGVyUHJvcGVydGllcykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJCb3JkZXIiLAogICAgICAgICAgICAgIHByb3BlcnRpZXM6IFt7bmFtZTogIlBvc2l0aW9uIiwgdmFsdWU6ICJSaWdodCJ9XS5jb25jYXQoYm9yZGVyUHJvcGVydGllcykKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0KICAgICAgXQogICAgfSk7CiAgfSwKICAKICBhZGRUaXRsZVN0eWxlOiBmdW5jdGlvbigpIHsKICAgIHRoaXMuYWRkU3R5bGUoewogICAgICBpZDogInRpdGxlIiwKICAgICAgYXR0cmlidXRlczogWwogICAgICAgIHtuYW1lOiAiQm9yZGVycyJ9LAogICAgICAgIHtuYW1lOiAiRm9udCJ9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJOdW1iZXJGb3JtYXQiLAogICAgICAgICAgcHJvcGVydGllczogWwogICAgICAgICAgICB7bmFtZTogIkZvcm1hdCIsIHZhbHVlOiAiQCJ9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAiQWxpZ25tZW50IiwKICAgICAgICAgIHByb3BlcnRpZXM6IFsKICAgICAgICAgICAge25hbWU6ICJXcmFwVGV4dCIsICAgdmFsdWU6ICIxIn0sCiAgICAgICAgICAgIHtuYW1lOiAiSG9yaXpvbnRhbCIsIHZhbHVlOiAiQ2VudGVyIn0sCiAgICAgICAgICAgIHtuYW1lOiAiVmVydGljYWwiLCAgIHZhbHVlOiAiQ2VudGVyIn0KICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIF0KICAgIH0pOwogIH0sCiAgCiAgYWRkSGVhZGVyU3R5bGU6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5hZGRTdHlsZSh7CiAgICAgIGlkOiAiaGVhZGVyY2VsbCIsCiAgICAgIGF0dHJpYnV0ZXM6IFsKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAiRm9udCIsCiAgICAgICAgICBwcm9wZXJ0aWVzOiBbCiAgICAgICAgICAgIHtuYW1lOiAiQm9sZCIsIHZhbHVlOiAiMSJ9LAogICAgICAgICAgICB7bmFtZTogIlNpemUiLCB2YWx1ZTogIjEwIn0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJJbnRlcmlvciIsCiAgICAgICAgICBwcm9wZXJ0aWVzOiBbCiAgICAgICAgICAgIHtuYW1lOiAiUGF0dGVybiIsIHZhbHVlOiAiU29saWQifSwKICAgICAgICAgICAge25hbWU6ICJDb2xvciIsICAgdmFsdWU6ICIjQjNCM0IzIn0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJBbGlnbm1lbnQiLAogICAgICAgICAgcHJvcGVydGllczogWwogICAgICAgICAgICB7bmFtZTogIldyYXBUZXh0IiwgICB2YWx1ZTogIjEifSwKICAgICAgICAgICAge25hbWU6ICJIb3Jpem9udGFsIiwgdmFsdWU6ICJDZW50ZXIifQogICAgICAgICAgXQogICAgICAgIH0KICAgICAgXQogICAgfSk7CiAgfSwKICAKICAvKioKICAgKiBBZGRzIHRoZSBkZWZhdWx0IHN0cmlwaW5nIHN0eWxlcyB0byB0aGlzIHdvcmtib29rCiAgICovCiAgYWRkU3RyaXBlZFN0eWxlczogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmFkZFN0eWxlKHsKICAgICAgaWQ6ICJldmVuIiwKICAgICAgYXR0cmlidXRlczogWwogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJJbnRlcmlvciIsCiAgICAgICAgICBwcm9wZXJ0aWVzOiBbCiAgICAgICAgICAgIHtuYW1lOiAiUGF0dGVybiIsIHZhbHVlOiAiU29saWQifSwKICAgICAgICAgICAge25hbWU6ICJDb2xvciIsICAgdmFsdWU6ICIjRkZGRkZGIn0KICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIF0KICAgIH0pOwogICAgCiAgICB0aGlzLmFkZFN0eWxlKHsKICAgICAgaWQ6ICJvZGQiLAogICAgICBhdHRyaWJ1dGVzOiBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogIkludGVyaW9yIiwKICAgICAgICAgIHByb3BlcnRpZXM6IFsKICAgICAgICAgICAge25hbWU6ICJQYXR0ZXJuIiwgdmFsdWU6ICJTb2xpZCJ9LAogICAgICAgICAgICB7bmFtZTogIkNvbG9yIiwgICB2YWx1ZTogIiNFNkU2RTYifQogICAgICAgICAgXQogICAgICAgIH0KICAgICAgXQogICAgfSk7CiAgICAKICAgIEV4dC5lYWNoKFsnZXZlbicsICdvZGQnXSwgZnVuY3Rpb24ocGFyZW50U3R5bGUpIHsKICAgICAgdGhpcy5hZGRDaGlsZE51bWJlckZvcm1hdFN0eWxlKHBhcmVudFN0eWxlLCBwYXJlbnRTdHlsZSArICdkYXRlJywgIltFTkddWyQtNDA5XWRkXC1tbW1cLXl5eXk7QCIpOwogICAgICB0aGlzLmFkZENoaWxkTnVtYmVyRm9ybWF0U3R5bGUocGFyZW50U3R5bGUsIHBhcmVudFN0eWxlICsgJ2ludCcsICIwIik7CiAgICAgIHRoaXMuYWRkQ2hpbGROdW1iZXJGb3JtYXRTdHlsZShwYXJlbnRTdHlsZSwgcGFyZW50U3R5bGUgKyAnZmxvYXQnLCAiMC4wMCIpOwogICAgfSwgdGhpcyk7ICAgIAogIH0sCiAgCiAgLyoqCiAgICogUHJpdmF0ZSBjb252ZW5pZW5jZSBmdW5jdGlvbiB0byBlYXNpbHkgYWRkIGEgTnVtYmVyRm9ybWF0IHN0eWxlIGZvciBhIGdpdmVuIHBhcmVudFN0eWxlCiAgICogQHBhcmFtIHtTdHJpbmd9IHBhcmVudFN0eWxlIFRoZSBJRCBvZiB0aGUgcGFyZW50U3R5bGUgU3R5bGUKICAgKiBAcGFyYW0ge1N0cmluZ30gaWQgVGhlIElEIG9mIHRoZSBuZXcgc3R5bGUKICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWUgVGhlIHZhbHVlIG9mIHRoZSBOdW1iZXJGb3JtYXQncyBGb3JtYXQgcHJvcGVydHkKICAgKi8KICBhZGRDaGlsZE51bWJlckZvcm1hdFN0eWxlOiBmdW5jdGlvbihwYXJlbnRTdHlsZSwgaWQsIHZhbHVlKSB7CiAgICB0aGlzLmFkZFN0eWxlKHsKICAgICAgaWQ6IGlkLAogICAgICBwYXJlbnRTdHlsZTogImV2ZW4iLAogICAgICBhdHRyaWJ1dGVzOiBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogIk51bWJlckZvcm1hdCIsCiAgICAgICAgICBwcm9wZXJ0aWVzOiBbe25hbWU6ICJGb3JtYXQiLCB2YWx1ZTogdmFsdWV9XQogICAgICAgIH0KICAgICAgXQogICAgfSk7CiAgfQp9KTsKCi8qKgogKiBAY2xhc3MgRXh0LnV4LkV4cG9ydGVyLkV4Y2VsRm9ybWF0dGVyLldvcmtzaGVldAogKiBAZXh0ZW5kcyBPYmplY3QKICogUmVwcmVzZW50cyBhbiBFeGNlbCB3b3Jrc2hlZXQKICogQGNmZyB7RXh0LmRhdGEuU3RvcmV9IHN0b3JlIFRoZSBzdG9yZSB0byB1c2UgKHJlcXVpcmVkKQogKi8KRXh0LnV4LkV4cG9ydGVyLkV4Y2VsRm9ybWF0dGVyLldvcmtzaGVldCA9IEV4dC5leHRlbmQoT2JqZWN0LCB7CgogIGNvbnN0cnVjdG9yOiBmdW5jdGlvbihzdG9yZSwgY29uZmlnKSB7CiAgICBjb25maWcgPSBjb25maWcgfHwge307CiAgICAKICAgIHRoaXMuc3RvcmUgPSBzdG9yZTsKICAgIAogICAgRXh0LmFwcGx5SWYoY29uZmlnLCB7CiAgICAgIGhhc1RpdGxlICAgOiB0cnVlLAogICAgICBoYXNIZWFkaW5nczogdHJ1ZSwKICAgICAgc3RyaXBlUm93cyA6IHRydWUsCiAgICAgIAogICAgICB0aXRsZSAgICAgIDogIldvcmtib29rIiwKICAgICAgY29sdW1ucyAgICA6IHN0b3JlLmZpZWxkcyA9PSB1bmRlZmluZWQgPyB7fSA6IHN0b3JlLmZpZWxkcy5pdGVtcwogICAgfSk7CiAgICAKICAgIEV4dC5hcHBseSh0aGlzLCBjb25maWcpOwogICAgCiAgICBFeHQudXguRXhwb3J0ZXIuRXhjZWxGb3JtYXR0ZXIuV29ya3NoZWV0LnN1cGVyY2xhc3MuY29uc3RydWN0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9LAogIAogIC8qKgogICAqIEBwcm9wZXJ0eSBkYXRlRm9ybWF0U3RyaW5nCiAgICogQHR5cGUgU3RyaW5nCiAgICogU3RyaW5nIHVzZWQgdG8gZm9ybWF0IGRhdGVzIChkZWZhdWx0cyB0byAiWS1tLWQiKS4gQWxsIG90aGVyIGRhdGEgdHlwZXMgYXJlIGxlZnQgdW5tb2xlc3RlZAogICAqLwogIGRhdGVGb3JtYXRTdHJpbmc6ICJZLW0tZCIsCiAgCiAgd29ya3NoZWV0VHBsOiBuZXcgRXh0LlhUZW1wbGF0ZSgKICAgICc8c3M6V29ya3NoZWV0IHNzOk5hbWU9Int0aXRsZX0iPicsCiAgICAgICc8c3M6TmFtZXM+JywKICAgICAgICAnPHNzOk5hbWVkUmFuZ2Ugc3M6TmFtZT0iUHJpbnRfVGl0bGVzIiBzczpSZWZlcnNUbz0iPVwne3RpdGxlfVwnIVIxOlIyIiAvPicsCiAgICAgICc8L3NzOk5hbWVzPicsCiAgICAgICc8c3M6VGFibGUgeDpGdWxsUm93cz0iMSIgeDpGdWxsQ29sdW1ucz0iMSIgc3M6RXhwYW5kZWRDb2x1bW5Db3VudD0ie2NvbENvdW50fSIgc3M6RXhwYW5kZWRSb3dDb3VudD0ie3Jvd0NvdW50fSI+JywKICAgICAgICAne2NvbHVtbnN9JywKICAgICAgICAnPHNzOlJvdyBzczpIZWlnaHQ9IjM4Ij4nLAogICAgICAgICAgICAnPHNzOkNlbGwgc3M6U3R5bGVJRD0idGl0bGUiIHNzOk1lcmdlQWNyb3NzPSJ7Y29sQ291bnQgLSAxfSI+JywKICAgICAgICAgICAgICAnPHNzOkRhdGEgeG1sbnM6aHRtbD0iaHR0cDovL3d3dy53My5vcmcvVFIvUkVDLWh0bWw0MCIgc3M6VHlwZT0iU3RyaW5nIj4nLAogICAgICAgICAgICAgICAgJzxodG1sOkI+PGh0bWw6VT48aHRtbDpGb250IGh0bWw6U2l6ZT0iMTUiPnt0aXRsZX0nLAogICAgICAgICAgICAgICAgJzwvaHRtbDpGb250PjwvaHRtbDpVPjwvaHRtbDpCPjwvc3M6RGF0YT48c3M6TmFtZWRDZWxsIHNzOk5hbWU9IlByaW50X1RpdGxlcyIgLz4nLAogICAgICAgICAgICAnPC9zczpDZWxsPicsCiAgICAgICAgJzwvc3M6Um93PicsCiAgICAgICAgJzxzczpSb3cgc3M6QXV0b0ZpdEhlaWdodD0iMSI+JywKICAgICAgICAgICd7aGVhZGVyfScsCiAgICAgICAgJzwvc3M6Um93PicsCiAgICAgICAgJ3tyb3dzfScsCiAgICAgICc8L3NzOlRhYmxlPicsCiAgICAgICc8eDpXb3Jrc2hlZXRPcHRpb25zPicsCiAgICAgICAgJzx4OlBhZ2VTZXR1cD4nLAogICAgICAgICAgJzx4OkxheW91dCB4OkNlbnRlckhvcml6b250YWw9IjEiIHg6T3JpZW50YXRpb249IkxhbmRzY2FwZSIgLz4nLAogICAgICAgICAgJzx4OkZvb3RlciB4OkRhdGE9IlBhZ2UgJmFtcDtQIG9mICZhbXA7TiIgeDpNYXJnaW49IjAuNSIgLz4nLAogICAgICAgICAgJzx4OlBhZ2VNYXJnaW5zIHg6VG9wPSIwLjUiIHg6UmlnaHQ9IjAuNSIgeDpMZWZ0PSIwLjUiIHg6Qm90dG9tPSIwLjgiIC8+JywKICAgICAgICAnPC94OlBhZ2VTZXR1cD4nLAogICAgICAgICc8eDpGaXRUb1BhZ2UgLz4nLAogICAgICAgICc8eDpQcmludD4nLAogICAgICAgICAgJzx4OlByaW50RXJyb3JzPkJsYW5rPC94OlByaW50RXJyb3JzPicsCiAgICAgICAgICAnPHg6Rml0V2lkdGg+MTwveDpGaXRXaWR0aD4nLAogICAgICAgICAgJzx4OkZpdEhlaWdodD4zMjc2NzwveDpGaXRIZWlnaHQ+JywKICAgICAgICAgICc8eDpWYWxpZFByaW50ZXJJbmZvIC8+JywKICAgICAgICAgICc8eDpWZXJ0aWNhbFJlc29sdXRpb24+NjAwPC94OlZlcnRpY2FsUmVzb2x1dGlvbj4nLAogICAgICAgICc8L3g6UHJpbnQ+JywKICAgICAgICAnPHg6U2VsZWN0ZWQgLz4nLAogICAgICAgICc8eDpEb05vdERpc3BsYXlHcmlkbGluZXMgLz4nLAogICAgICAgICc8eDpQcm90ZWN0T2JqZWN0cz5GYWxzZTwveDpQcm90ZWN0T2JqZWN0cz4nLAogICAgICAgICc8eDpQcm90ZWN0U2NlbmFyaW9zPkZhbHNlPC94OlByb3RlY3RTY2VuYXJpb3M+JywKICAgICAgJzwveDpXb3Jrc2hlZXRPcHRpb25zPicsCiAgICAnPC9zczpXb3Jrc2hlZXQ+JwogICksCiAgCiAgLyoqCiAgICogQnVpbGRzIHRoZSBXb3Jrc2hlZXQgWE1MCiAgICogQHBhcmFtIHtFeHQuZGF0YS5TdG9yZX0gc3RvcmUgVGhlIHN0b3JlIHRvIGJ1aWxkIGZyb20KICAgKi8KICByZW5kZXI6IGZ1bmN0aW9uKHN0b3JlKSB7CiAgICByZXR1cm4gdGhpcy53b3Jrc2hlZXRUcGwuYXBwbHkoewogICAgICBoZWFkZXIgIDogdGhpcy5idWlsZEhlYWRlcigpLAogICAgICBjb2x1bW5zIDogdGhpcy5idWlsZENvbHVtbnMoKS5qb2luKCIiKSwKICAgICAgcm93cyAgICA6IHRoaXMuYnVpbGRSb3dzKCkuam9pbigiIiksCiAgICAgIGNvbENvdW50OiB0aGlzLmNvbHVtbnMubGVuZ3RoLAogICAgICByb3dDb3VudDogdGhpcy5zdG9yZS5nZXRDb3VudCgpICsgMiwKICAgICAgdGl0bGUgICA6IHRoaXMudGl0bGUKICAgIH0pOwogIH0sCiAgCiAgYnVpbGRDb2x1bW5zOiBmdW5jdGlvbigpIHsKICAgIHZhciBjb2xzID0gW107CiAgICAKICAgIEV4dC5lYWNoKHRoaXMuY29sdW1ucywgZnVuY3Rpb24oY29sdW1uKSB7CiAgICAgIGNvbHMucHVzaCh0aGlzLmJ1aWxkQ29sdW1uKCkpOwogICAgfSwgdGhpcyk7CiAgICAKICAgIHJldHVybiBjb2xzOwogIH0sCiAgCiAgYnVpbGRDb2x1bW46IGZ1bmN0aW9uKHdpZHRoKSB7CiAgICByZXR1cm4gU3RyaW5nLmZvcm1hdCgnPHNzOkNvbHVtbiBzczpBdXRvRml0V2lkdGg9IjEiIHNzOldpZHRoPSJ7MH0iIC8+Jywgd2lkdGggfHwgMTY0KTsKICB9LAogIAogIGJ1aWxkUm93czogZnVuY3Rpb24oKSB7CiAgICB2YXIgcm93cyA9IFtdOwogICAgCiAgICB0aGlzLnN0b3JlLmVhY2goZnVuY3Rpb24ocmVjb3JkLCBpbmRleCkgewogICAgICByb3dzLnB1c2godGhpcy5idWlsZFJvdyhyZWNvcmQsIGluZGV4KSk7CiAgICB9LCB0aGlzKTsKICAgIAogICAgcmV0dXJuIHJvd3M7CiAgfSwKICAKICBidWlsZEhlYWRlcjogZnVuY3Rpb24oKSB7CiAgICB2YXIgY2VsbHMgPSBbXTsKICAgIAogICAgRXh0LmVhY2godGhpcy5jb2x1bW5zLCBmdW5jdGlvbihjb2wpIHsKICAgICAgdmFyIHRpdGxlOwogICAgICAKICAgICAgaWYgKGNvbC5oZWFkZXIgIT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGl0bGUgPSBjb2wuaGVhZGVyOwogICAgICB9IGVsc2UgewogICAgICAgIC8vbWFrZSBjb2x1bW5zIHRha2VuIGZyb20gUmVjb3JkIGZpZWxkcyAoZS5nLiB3aXRoIGEgY29sLm5hbWUpIGh1bWFuLXJlYWRhYmxlCiAgICAgICAgdGl0bGUgPSBjb2wubmFtZS5yZXBsYWNlKC9fL2csICIgIik7CiAgICAgICAgdGl0bGUgPSB0aXRsZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHRpdGxlLnN1YnN0cigxKS50b0xvd2VyQ2FzZSgpOwogICAgICB9CiAgICAgIAogICAgICBjZWxscy5wdXNoKFN0cmluZy5mb3JtYXQoJzxzczpDZWxsIHNzOlN0eWxlSUQ9ImhlYWRlcmNlbGwiPjxzczpEYXRhIHNzOlR5cGU9IlN0cmluZyI+ezB9PC9zczpEYXRhPjxzczpOYW1lZENlbGwgc3M6TmFtZT0iUHJpbnRfVGl0bGVzIiAvPjwvc3M6Q2VsbD4nLCB0aXRsZSkpOwogICAgfSwgdGhpcyk7CiAgICAKICAgIHJldHVybiBjZWxscy5qb2luKCIiKTsKICB9LAogIAogIGJ1aWxkUm93OiBmdW5jdGlvbihyZWNvcmQsIGluZGV4KSB7CiAgICB2YXIgc3R5bGUsCiAgICAgICAgY2VsbHMgPSBbXTsKICAgIGlmICh0aGlzLnN0cmlwZVJvd3MgPT09IHRydWUpIHN0eWxlID0gaW5kZXggJSAyID09IDAgPyAnZXZlbicgOiAnb2RkJzsKICAgIAogICAgRXh0LmVhY2godGhpcy5jb2x1bW5zLCBmdW5jdGlvbihjb2wpIHsKICAgICAgdmFyIG5hbWUgID0gY29sLm5hbWUgfHwgY29sLmRhdGFJbmRleDsKICAgICAgCiAgICAgIC8vaWYgZ2l2ZW4gYSByZW5kZXJlciB2aWEgYSBDb2x1bW5Nb2RlbCwgdXNlIGl0IGFuZCBlbnN1cmUgZGF0YSB0eXBlIGlzIHNldCB0byBTdHJpbmcKICAgICAgaWYgKEV4dC5pc0Z1bmN0aW9uKGNvbC5yZW5kZXJlcikpIHsKICAgICAgICB2YXIgdmFsdWUgPSBjb2wucmVuZGVyZXIocmVjb3JkLmdldChuYW1lKSwgbnVsbCwgcmVjb3JkKSwKICAgICAgICAgICAgdHlwZSA9ICJTdHJpbmciOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciB2YWx1ZSA9IHJlY29yZC5nZXQobmFtZSksCiAgICAgICAgICAgIHR5cGUgID0gdGhpcy50eXBlTWFwcGluZ3NbY29sLnR5cGUgfHwgcmVjb3JkLmZpZWxkcy5pdGVtKG5hbWUpLnR5cGVdOwogICAgICB9CiAgICAgIAogICAgICBjZWxscy5wdXNoKHRoaXMuYnVpbGRDZWxsKHZhbHVlLCB0eXBlLCBzdHlsZSkucmVuZGVyKCkpOwogICAgfSwgdGhpcyk7CiAgICAKICAgIHJldHVybiBTdHJpbmcuZm9ybWF0KCI8c3M6Um93PnswfTwvc3M6Um93PiIsIGNlbGxzLmpvaW4oIiIpKTsKICB9LAogIAogIGJ1aWxkQ2VsbDogZnVuY3Rpb24odmFsdWUsIHR5cGUsIHN0eWxlKSB7CiAgICBpZiAodHlwZSA9PSAiRGF0ZVRpbWUiICYmIEV4dC5pc0Z1bmN0aW9uKHZhbHVlLmZvcm1hdCkpIHZhbHVlID0gdmFsdWUuZm9ybWF0KHRoaXMuZGF0ZUZvcm1hdFN0cmluZyk7CiAgICAvL1RPRE8KCXZhbHVlPXN0cmlwVGFncyh2YWx1ZSk7CiAgICByZXR1cm4gbmV3IEV4dC51eC5FeHBvcnRlci5FeGNlbEZvcm1hdHRlci5DZWxsKHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICB0eXBlIDogdHlwZSwKICAgICAgc3R5bGU6IHN0eWxlCiAgICB9KTsKICB9LAogIAogIC8qKgogICAqIEBwcm9wZXJ0eSB0eXBlTWFwcGluZ3MKICAgKiBAdHlwZSBPYmplY3QKICAgKiBNYXBwaW5ncyBmcm9tIEV4dC5kYXRhLlJlY29yZCB0eXBlcyB0byBFeGNlbCB0eXBlcwogICAqLwogIHR5cGVNYXBwaW5nczogewogICAgJ2ludCcgICA6ICJOdW1iZXIiLAogICAgJ3N0cmluZyc6ICJTdHJpbmciLAogICAgJ2Zsb2F0JyA6ICJOdW1iZXIiLAogICAgJ2RhdGUnICA6ICJEYXRlVGltZSIKICB9Cn0pOwoKLyoqCiAqIEBjbGFzcyBFeHQudXguRXhwb3J0ZXIuRXhjZWxGb3JtYXR0ZXIuQ2VsbAogKiBAZXh0ZW5kcyBPYmplY3QKICogUmVwcmVzZW50cyBhIHNpbmdsZSBjZWxsIGluIGEgd29ya3NoZWV0CiAqLwpFeHQudXguRXhwb3J0ZXIuRXhjZWxGb3JtYXR0ZXIuQ2VsbCA9IEV4dC5leHRlbmQoT2JqZWN0LCB7CgogIGNvbnN0cnVjdG9yOiBmdW5jdGlvbihjb25maWcpIHsKICAgIEV4dC5hcHBseUlmKGNvbmZpZywgewogICAgICB0eXBlOiAiU3RyaW5nIgogICAgfSk7CiAgICAKICAgIEV4dC5hcHBseSh0aGlzLCBjb25maWcpOwogICAgCiAgICBFeHQudXguRXhwb3J0ZXIuRXhjZWxGb3JtYXR0ZXIuQ2VsbC5zdXBlcmNsYXNzLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfSwKICAKICByZW5kZXI6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMudHBsLmFwcGx5KHRoaXMpOwogIH0sCiAgCiAgdHBsOiBuZXcgRXh0LlhUZW1wbGF0ZSgKICAgICc8c3M6Q2VsbCBzczpTdHlsZUlEPSJ7c3R5bGV9Ij4nLAogICAgICAnPHNzOkRhdGEgc3M6VHlwZT0ie3R5cGV9Ij48IVtDREFUQVt7dmFsdWV9XV0+PC9zczpEYXRhPicsCiAgICAnPC9zczpDZWxsPicKICApCn0pOwoKLyoqCiAqIEBjbGFzcyBFeHQudXguRXhwb3J0ZXIuRXhjZWxGb3JtYXR0ZXIuU3R5bGUKICogQGV4dGVuZHMgT2JqZWN0CiAqIFJlcHJlc2VudHMgYSBzdHlsZSBkZWNsYXJhdGlvbiBmb3IgYSBXb3JrYm9vayAodGhpcyBpcyBsaWtlIGRlZmluaW5nIENTUyBydWxlcykuIEV4YW1wbGU6CiAqIAogKiBuZXcgRXh0LnV4LkV4cG9ydGVyLkV4Y2VsRm9ybWF0dGVyLlN0eWxlKHsKICogICBhdHRyaWJ1dGVzOiBbCiAqICAgICB7CiAqICAgICAgIG5hbWU6ICJBbGlnbm1lbnQiLAogKiAgICAgICBwcm9wZXJ0aWVzOiBbCiAqICAgICAgICAge25hbWU6ICJWZXJ0aWNhbCIsIHZhbHVlOiAiVG9wIn0sCiAqICAgICAgICAge25hbWU6ICJXcmFwVGV4dCIsIHZhbHVlOiAiMSJ9CiAqICAgICAgIF0KICogICAgIH0sCiAqICAgICB7CiAqICAgICAgIG5hbWU6ICJCb3JkZXJzIiwKICogICAgICAgY2hpbGRyZW46IFsKICogICAgICAgICBuYW1lOiAiQm9yZGVyIiwKICogICAgICAgICBwcm9wZXJ0aWVzOiBbCiAqICAgICAgICAgICB7bmFtZTogIkNvbG9yIiwgdmFsdWU6ICIjZTRlNGU0In0sCiAqICAgICAgICAgICB7bmFtZTogIldlaWdodCIsIHZhbHVlOiAiMSJ9CiAqICAgICAgICAgXQogKiAgICAgICBdCiAqICAgICB9CiAqICAgXQogKiB9KQogKiAKICogQGNmZyB7U3RyaW5nfSBpZCBUaGUgSUQgb2YgdGhpcyBzdHlsZSAocmVxdWlyZWQpCiAqIEBjZmcge0FycmF5fSBhdHRyaWJ1dGVzIFRoZSBhdHRyaWJ1dGVzIGZvciB0aGlzIHN0eWxlCiAqIEBjZmcge1N0cmluZ30gcGFyZW50U3R5bGUgVGhlIChvcHRpb25hbCBwYXJlbnRTdHlsZSBJRCkKICovCkV4dC51eC5FeHBvcnRlci5FeGNlbEZvcm1hdHRlci5TdHlsZSA9IEV4dC5leHRlbmQoT2JqZWN0LCB7CgogIGNvbnN0cnVjdG9yOiBmdW5jdGlvbihjb25maWcpIHsKICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTsKICAgIAogICAgRXh0LmFwcGx5KHRoaXMsIGNvbmZpZywgewogICAgICBwYXJlbnRTdHlsZTogJycsCiAgICAgIGF0dHJpYnV0ZXMgOiBbXQogICAgfSk7CiAgICAKICAgIEV4dC51eC5FeHBvcnRlci5FeGNlbEZvcm1hdHRlci5TdHlsZS5zdXBlcmNsYXNzLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAKICAgIGlmICh0aGlzLmlkID09IHVuZGVmaW5lZCkgdGhyb3cgbmV3IEVycm9yKCJBbiBJRCBtdXN0IGJlIHByb3ZpZGVkIHRvIFN0eWxlIik7CiAgICAKICAgIHRoaXMucHJlcGFyZVByb3BlcnR5U3RyaW5ncygpOwogIH0sCiAgCiAgLyoqCiAgICogSXRlcmF0ZXMgb3ZlciB0aGUgYXR0cmlidXRlcyBpbiB0aGlzIHN0eWxlLCBhbmQgYW55IGNoaWxkcmVuIHRoZXkgbWF5IGhhdmUsIGNyZWF0aW5nIHByb3BlcnR5CiAgICogc3RyaW5ncyBvbiBlYWNoIHN1aXRhYmxlIGZvciB1c2UgaW4gdGhlIFhUZW1wbGF0ZQogICAqLwogIHByZXBhcmVQcm9wZXJ0eVN0cmluZ3M6IGZ1bmN0aW9uKCkgewogICAgRXh0LmVhY2godGhpcy5hdHRyaWJ1dGVzLCBmdW5jdGlvbihhdHRyLCBpbmRleCkgewogICAgICB0aGlzLmF0dHJpYnV0ZXNbaW5kZXhdLnByb3BlcnRpZXNTdHJpbmcgPSB0aGlzLmJ1aWxkUHJvcGVydHlTdHJpbmcoYXR0cik7CiAgICAgIHRoaXMuYXR0cmlidXRlc1tpbmRleF0uY2hpbGRyZW4gPSBhdHRyLmNoaWxkcmVuIHx8IFtdOwogICAgICAKICAgICAgRXh0LmVhY2goYXR0ci5jaGlsZHJlbiwgZnVuY3Rpb24oY2hpbGQsIGNoaWxkSW5kZXgpIHsKICAgICAgICB0aGlzLmF0dHJpYnV0ZXNbaW5kZXhdLmNoaWxkcmVuW2NoaWxkSW5kZXhdLnByb3BlcnRpZXNTdHJpbmcgPSB0aGlzLmJ1aWxkUHJvcGVydHlTdHJpbmcoY2hpbGQpOwogICAgICB9LCB0aGlzKTsKICAgIH0sIHRoaXMpOwogIH0sCiAgCiAgLyoqCiAgICogQnVpbGRzIGEgY29uY2F0ZW5hdGVkIHByb3BlcnR5IHN0cmluZyBmb3IgYSBnaXZlbiBhdHRyaWJ1dGUsIHN1aXRhYmxlIGZvciB1c2UgaW4gdGhlIFhUZW1wbGF0ZQogICAqLwogIGJ1aWxkUHJvcGVydHlTdHJpbmc6IGZ1bmN0aW9uKGF0dHJpYnV0ZSkgewogICAgdmFyIHByb3BlcnRpZXNTdHJpbmcgPSAiIjsKICAgIAogICAgRXh0LmVhY2goYXR0cmlidXRlLnByb3BlcnRpZXMgfHwgW10sIGZ1bmN0aW9uKHByb3BlcnR5KSB7CiAgICAgIHByb3BlcnRpZXNTdHJpbmcgKz0gU3RyaW5nLmZvcm1hdCgnc3M6ezB9PSJ7MX0iICcsIHByb3BlcnR5Lm5hbWUsIHByb3BlcnR5LnZhbHVlKTsKICAgIH0sIHRoaXMpOwogICAgCiAgICByZXR1cm4gcHJvcGVydGllc1N0cmluZzsKICB9LAogIAogIHJlbmRlcjogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy50cGwuYXBwbHkodGhpcyk7CiAgfSwKICAKICB0cGw6IG5ldyBFeHQuWFRlbXBsYXRlKAogICAgJzx0cGwgaWY9InBhcmVudFN0eWxlLmxlbmd0aCA9PSAwIj4nLAogICAgICAnPHNzOlN0eWxlIHNzOklEPSJ7aWR9Ij4nLAogICAgJzwvdHBsPicsCiAgICAnPHRwbCBpZj0icGFyZW50U3R5bGUubGVuZ3RoICE9IDAiPicsCiAgICAgICc8c3M6U3R5bGUgc3M6SUQ9IntpZH0iIHNzOlBhcmVudD0ie3BhcmVudFN0eWxlfSI+JywKICAgICc8L3RwbD4nLAogICAgJzx0cGwgZm9yPSJhdHRyaWJ1dGVzIj4nLAogICAgICAnPHRwbCBpZj0iY2hpbGRyZW4ubGVuZ3RoID09IDAiPicsCiAgICAgICAgJzxzczp7bmFtZX0ge3Byb3BlcnRpZXNTdHJpbmd9IC8+JywKICAgICAgJzwvdHBsPicsCiAgICAgICc8dHBsIGlmPSJjaGlsZHJlbi5sZW5ndGggPiAwIj4nLAogICAgICAgICc8c3M6e25hbWV9IHtwcm9wZXJ0aWVzU3RyaW5nfT4nLAogICAgICAgICAgJzx0cGwgZm9yPSJjaGlsZHJlbiI+JywKICAgICAgICAgICAgJzxzczp7bmFtZX0ge3Byb3BlcnRpZXNTdHJpbmd9IC8+JywKICAgICAgICAgICc8L3RwbD4nLAogICAgICAgICc8L3NzOntuYW1lfT4nLAogICAgICAnPC90cGw+JywKICAgICc8L3RwbD4nLAogICAgJzwvc3M6U3R5bGU+JwogICkKfSk7CgoKLyoqCiAqIExpdHRsZSBoZWxwZXIgZnVuY3Rpb24gdG8gc3RyaXAgdGFncyBmcm9tIGEgc3RyaW5nLgogKiBAcGFyYW0gc3RyTW9kCiAqIEByZXR1cm4gc3RyTW9kCiAqLwpmdW5jdGlvbiBzdHJpcFRhZ3Moc3RyTW9kKXsKCXN0ck1vZCA9IHN0ck1vZC5yZXBsYWNlKC88KC58XG4pKj8+L2dpLCAnJyk7Cgl2YXIJdGFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpOwoJdGFyZWEuaW5uZXJIVE1MID0gc3RyTW9kOwoJcmV0dXJuIHRhcmVhLnZhbHVlOwoJLy9yZXR1cm4gc3RyTW9kOwp9Cg==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>